machine:
    environment:
        PROJECT: $CIRCLE_PROJECT_REPONAME
        IMPORT_PATH: "github.com/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME"
        ROOTDIR: "/home/ubuntu/.go_workspace/src/$IMPORT_PATH"
dependencies:
    override:
        - cd $ROOTDIR && go get -t -d -v ./...
    post:
        - go get github.com/golang/lint/golint
test:
    pre:
        - go version
        - go env
    override:
        - cd $ROOTDIR && go vet ./...
        - cd $ROOTDIR && golint ./...
    post:
        - GOOS=linux   GOARCH=amd64 go build -o $CIRCLE_ARTIFACTS/$PROJECT.linux.amd64       $IMPORT_PATH
#        - GOOS=darwin  GOARCH=amd64 go build -o $CIRCLE_ARTIFACTS/$PROJECT.darwin.amd64      $IMPORT_PATH
#        - GOOS=freebsd GOARCH=amd64 go build -o $CIRCLE_ARTIFACTS/$PROJECT.freebsd.amd64     $IMPORT_PATH
#        - GOOS=windows GOARCH=amd64 go build -o $CIRCLE_ARTIFACTS/$PROJECT.windows.amd64.exe $IMPORT_PATH
        - find $CIRCLE_ARTIFACTS -type f -exec shasum -a 256 {} \; | tee $CIRCLE_ARTIFACTS/sha256.txt
